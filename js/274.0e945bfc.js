"use strict";(self["webpackChunkvue_week7"]=self["webpackChunkvue_week7"]||[]).push([[274],{7565:function(e,a,t){t.d(a,{Z:function(){return h}});var o=t(6252),n=t(2262),s=t(8262),r=t(9669),c=t.n(r);const d=(0,s.Q_)("admin",(()=>{const e=(0,o.f3)("axios"),a="https://vue3-course-api.hexschool.io/v2/",t=(0,n.iH)(""),s=(0,n.iH)(""),r=(0,n.iH)(!1);function d(){c().defaults.headers.common.Authorization=t.value,e.post(`${a}api/user/check`).then((e=>(r.value=e.data.success,e.data.success))).catch((e=>(console.dir(e),r.value=e.response.data.success,e.response.data.success)))}function l(){const e=document.cookie.split("; backendToken="),a=e.shift().split(";");return a.forEach((e=>{e.trim().startsWith("backendToken=")&&(t.value=e.trim().split("=")["1"])})),e}function i(e){t.value=e.token,s.value=e.expired,r.value=!0,document.cookie=`backendToken=${e.token}; expires=${new Date(e.expired)};`}function u(){r.value=!1,t.value="",s.value="",e.post(`${a}api/user/logout`)}function p(){document.cookie=`backendToken=; expires=${new Date(0)};`}return{token:t,expired:s,isLoggedIn:r,handleSetLogin:i,handleSetLogout:u,handleCheckUser:d,handleGetToken:l,handleClearToken:p}}));const l=(0,s.Q_)("adminData",(()=>{const e=(0,o.f3)("axios"),a="https://vue3-course-api.hexschool.io/v2/",t="club",s=(0,n.qj)({selectedTarget:"product",selectedTargetIndex:0,dataList:[],pagination:{},currentPage:1,category:null,tempProduct:{},isOpenModal:!1}),r=(0,n.qj)({selected:""});function c(e,a){r.selected=e,s.tempProduct=a}function l(e=!1){s.isOpenModal=e}const i=d();function u(){let o=s.selectedTarget;switch(o){case"product":o="products/all";break;case"order":o="orders";break;case"coupon":o="coupons";break;case"article":o="articles";break;default:o="products";break}e.get(`${a}api/${t}/admin/${s.selectedTarget}`,{token:i.token}).then((e=>{s.dataList=e.data[`${o}`]})).catch((e=>{console.dir(e)}))}function p(o=s.currentPage,n=s.category){let r=s.selectedTarget;switch(r){case"product":r="products";break;case"order":r="orders";break;case"coupon":r="coupons";break;case"article":r="articles";break;default:r="products";break}let c=n;null===n&&(c=""),e.get(`${a}api/${t}/admin/${r}/${"product"!==r?`?page=${o}`:""}${c}`,{token:i.token}).then((e=>{s.dataList=e.data[`${r}`],s.pagination=e.data.pagination})).catch((e=>{console.dir(e)}))}function h(o,n){e.put(`${a}api/${t}/admin/${s.selectedTarget}/${o}`,n,{token:i.token}).then((()=>{p()})).catch((e=>{console.dir(e)}))}function m(o=null){let n=s.selectedTarget;switch(n){case"order":n="orders/all";break;case"coupon":n="coupon";break;default:n="products";break}e.delete(`${a}api/${t}/admin/${n}/${o}`,{token:i.token}).then((()=>{p()})).catch((e=>{console.dir(e)}))}function g(o){e.post(`${a}api/${t}/admin/${s.selectedTarget}`,o,{token:i.token}).then((()=>{p(s.currentPage)})).catch((e=>{console.dir(e)}))}function f(o){const n=new FormData;return n.append("file-to-upload",o),e.post(`${a}api/${t}/admin/upload`,n,{token:i.token})}return{adminData:s,functionSelected:r,handleControlModal:l,handleCreateData:g,handleGetDataAll:u,handleGetDataList:p,handleEditData:h,handleDeleteData:m,handleImageUpload:f,handleSelectFunction:c}}));const i=(0,s.Q_)("product",(()=>{const e=(0,o.f3)("axios"),a="https://vue3-course-api.hexschool.io/v2/",t="club",s=(0,n.qj)({products:[],pagination:{},currentPage:1,productDetail:{}}),r=(0,n.iH)(""),c=(0,n.iH)([]);function d(){e.get(`${a}api/${t}/products/all`).then((e=>{s.products=e.data.products,e.data.products.forEach((e=>{c.value.includes(e.category)||c.value.push(e.category)}))})).catch((e=>{console.dir(e)}))}function l(o="",n=s.currentPage){let r=o;"all"===o&&(r=""),console.log(r),e.get(`${a}api/${t}/products?page=${n}&category=${r}`).then((e=>{s.products=e.data.products,s.pagination=e.data.pagination})).catch((e=>{console.dir(e)}))}function i(o){r.value=o,e(`${a}api/${t}/product/${o}`).then((e=>{r.value="",s.productDetail=e.data.product})).catch((e=>{console.dir(e),r.value=""}))}return{productList:s,handleGetProductAll:d,handleGetProductList:l,productCategory:c,handleGetProductDetail:i,isLoading:r}}));const u=(0,s.Q_)("cart",(()=>{const e=(0,o.f3)("axios"),a="https://vue3-course-api.hexschool.io/v2/",t="club",s=(0,n.qj)({data:{},message:"",list:[],totalPrice:0,finalPrice:0}),r=(0,n.iH)("");function c(){e.get(`${a}api/${t}/cart`).then((e=>{s.list=e.data.data.carts,s.totalPrice=e.data.data.total,s.finalPrice=e.data.data.final_total})).catch((e=>{console.dir(e)}))}function d(o,n=1){r.value=o,e.post(`${a}api/${t}/cart`,{data:{product_id:o,qty:n}}).then((e=>{s.data=e.data.data,s.message=e.data.message,r.value="",c()})).catch((e=>{console.dir(e),r.value=""}))}function l(o){r.value=o,e.delete(`${a}api/${t}/cart/${o}`).then((e=>{s.message=e.data.message,r.value="",c()})).catch((e=>{console.dir(e),r.value=""}))}function i(o,n){r.value=o,e.put(`${a}api/${t}/cart/${o}`,{data:{data:{product_id:o,qty:n}}}).then((e=>{s.message=e.data.message,r.value="",c()})).catch((e=>{console.dir(e),r.value=""}))}function u(){e.delete(`${a}api/${t}/carts`).then((e=>{s.message=e.data.message,c()})).catch((e=>{console.dir(e)}))}return{cartData:s,isLoading:r,handleAddCart:d,handleGetCart:c,handleDeleteCart:l,handleUpdateCart:i,handleClearCart:u}}));const p=(0,s.Q_)("order",(()=>{const e=(0,o.f3)("axios"),a="https://vue3-course-api.hexschool.io/v2/",t="club",{handleGetCart:s}=u(),r=(0,n.qj)({success:!1,message:"",total:0,create_at:0,orderId:""}),c=(0,n.qj)({success:!1,orders:[],pagination:{},message:[]});function d(o){e.post(`${a}api/${t}/order`,{data:{user:{name:o.name,email:o.email,tel:o.tel,address:o.address},message:o.message}}).then((e=>{r.success=e.data.success,r.message=e.data.message,r.total=e.data.total,r.create_at=e.data.create_at,r.orderId=e.data.orderId,s()})).catch((e=>{console.dir(e)}))}function l(){e.get(`${a}api/${t}/orders`).then((e=>{c.success=e.data.success,c.orders=e.data.orders,c.pagination=e.data.pagination,c.message=e.data.message})).catch((e=>{console.dir(e)}))}return{orderResult:r,orderList:c,handleSendOrder:d,handleGetOrderList:l}}));function h(){const e=d(),a=l(),t=i(),o=p(),n=u();return{adminStore:e,adminDataStore:a,productStore:t,orderStore:o,cartStore:n}}},9274:function(e,a,t){t.r(a),t.d(a,{default:function(){return G}});var o=t(6252),n=t(9963),s=t(3577);const r={class:"flex justify-center items-center h-screen bg-gray-50"},c={class:"container max-w-lg"},d=(0,o._)("legend",{class:"text-3xl font-medium text-center text-primary-600 tracking-wide"},"管理者登入",-1),l={class:"space-y-4"},i=(0,o._)("label",{for:"name",class:"block font-normal"},"使用者帳號",-1),u={class:"space-y-4"},p=(0,o._)("label",{for:"password",class:"block font-normal"},"使用者密碼",-1),h=(0,o._)("button",{type:"submit",class:"py-4 w-full text-secondary-50 bg-secondary-400 rounded-lg hover:bg-secondary-600 transition duration-300"}," 登入 ",-1),m={class:"mb-2 text-center"};function g(e,a,t,g,f,v){const k=(0,o.up)("AlertModal");return(0,o.wg)(),(0,o.iD)("main",r,[(0,o._)("div",c,[(0,o._)("form",{class:"p-8 space-y-8 bg-white rounded shadow-sm",onSubmit:a[2]||(a[2]=(0,n.iM)(((...e)=>g.handlerSubmit&&g.handlerSubmit(...e)),["prevent"]))},[d,(0,o._)("div",l,[i,(0,o.wy)((0,o._)("input",{id:"name",type:"text",name:"userName",placeholder:"請輸入帳號Email","onUpdate:modelValue":a[0]||(a[0]=e=>g.userName=e),class:"p-2 w-full text-primary-800 border font-light focus:text-primary-600 bg-gray-50 rounded focus:border-primary-500 focus:ring-primary-500 invalid:border-primary-600 invalid:text-primary-600"},null,512),[[n.nr,g.userName,void 0,{trim:!0}]])]),(0,o._)("div",u,[p,(0,o.wy)((0,o._)("input",{id:"password",type:"password",class:"p-2 w-full text-primary-800 bg-gray-50 rounded border invalid:text-primary-600 invalid:border-primary-600 font-light focus:text-primary-600 focus:border-primary-500 focus:ring-primary-500","onUpdate:modelValue":a[1]||(a[1]=e=>g.userPassword=e),placeholder:"請輸入密碼"},null,512),[[n.nr,g.userPassword]])]),h],32)]),(0,o.Wm)(k,{modelValue:g.openModal,"onUpdate:modelValue":a[3]||(a[3]=e=>g.openModal=e),onCancel:g.cancel},{title:(0,o.w5)((()=>[(0,o.Uk)((0,s.zw)(g.modalMessage.title),1)])),default:(0,o.w5)((()=>[(0,o._)("p",m,(0,s.zw)(g.modalMessage.message),1),(0,o._)("p",null,(0,s.zw)(g.modalMessage.detail),1)])),_:1},8,["modelValue","onCancel"])])}var f=t(2262),v=t(2119),k=t(7565);const $={class:"bg-secondary-700 p-4 text-secondary-100 block relative"},b=["onClick"],y=(0,o._)("svg",{xmlns:"http://www.w3.org/2000/svg",fill:"currentColor",class:"w-8 h-8",viewBox:"0 0 16 16"},[(0,o._)("path",{d:"M4.646 4.646a.5.5 0 0 1 .708 0L8 7.293l2.646-2.647a.5.5 0 0 1 .708.708L8.707\n            8l2.647 2.646a.5.5 0 0 1-.708.708L8 8.707l-2.646 2.647a.5.5 0 0\n            1-.708-.708L7.293 8 4.646 5.354a.5.5 0 0 1 0-.708z"})],-1),w=[y],x={class:"p-4"},_={class:"flex justify-center items-center p-4"},C=["onClick"];function D(e,a,t,n,s,r){const c=(0,o.up)("vue-final-modal");return(0,o.wg)(),(0,o.j4)(c,(0,o.dG)(e.$attrs,{classes:"flex justify-center items-center bg-opacity-50 backdrop-blur-[2px]","content-class":"bg-gray-50 rounded-md shadow-md overflow-hidden min-w-[350px]"}),{default:(0,o.w5)((({params:a,close:t})=>[(0,o._)("span",$,[(0,o.WI)(e.$slots,"title"),(0,o._)("button",{class:"absolute top-0 right-0 p-2",onClick:t},w,8,b)]),(0,o._)("div",x,[(0,o.WI)(e.$slots,"default",{params:a})]),(0,o._)("div",_,[(0,o._)("button",{class:"py-2 px-4 bg-secondary-700 text-secondary-50 rounded w-1/3",onClick:a=>e.$emit("cancel",t)},"確定",8,C)])])),_:3},16)}var L={name:"AlertModal",inheritAttrs:!1,emits:["cancel"]},P=t(3744);const S=(0,P.Z)(L,[["render",D]]);var T=S,M={components:{AlertModal:T},setup(){const e="https://vue3-course-api.hexschool.io/v2/",a=(0,o.f3)("axios"),{adminStore:t}=(0,k.Z)(),{handleSetLogin:n,handleCheckUser:s,handleGetToken:r}=t,c=(0,v.tv)(),d=(0,f.iH)(""),l=(0,f.iH)(""),i=(0,f.qj)({title:"",message:"",detail:""}),u=(0,f.iH)(!1);function p(){const t=d.value,o=l.value;a.post(`${e}admin/signin`,{username:t,password:o}).then((e=>{const a={token:e.data.token,expired:e.data.expired};n(a),i.message=e.data.message,i.title="登入成功",u.value=!0,setTimeout((()=>{u.value=!1,c.push("/admin")}),3e3)})).catch((e=>{console.dir(e),i.message=e.response.data.message,i.detail=e.response.data.error.message,i.title="登入失敗",u.value=!0}))}const h=function(){u.value=!1};return(0,o.wF)((()=>{r(),s()?c.push("/login"):c.push("/admin")})),{userName:d,userPassword:l,handlerSubmit:p,openModal:u,cancel:h,modalMessage:i}}};const j=(0,P.Z)(M,[["render",g]]);var G=j}}]);
//# sourceMappingURL=274.0e945bfc.js.map